<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1145px" preserveAspectRatio="none" style="width:961px;height:1145px;background:#FFFFFF;" version="1.1" viewBox="0 0 961 1145" width="961px" zoomAndPan="magnify"><defs><filter height="300%" id="fnkoypq2m9jnh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="220" x="390.75" y="28.7219">ZigPC Discovery Behaviour</text><rect fill="#FFC0CB" filter="url(#fnkoypq2m9jnh)" height="667.6002" style="stroke:#000000;stroke-width:2.0;" width="934.5" x="8" y="447.1999"/><rect fill="#FFFFFF" height="570.8002" style="stroke:none;stroke-width:1.0;" width="934.5" x="8" y="543.9999"/><rect fill="#FFFFFF" filter="url(#fnkoypq2m9jnh)" height="360.8001" style="stroke:#000000;stroke-width:2.0;" width="890.5" x="27" y="641.2"/><rect fill="#FFC0CB" filter="url(#fnkoypq2m9jnh)" height="190.0001" style="stroke:#000000;stroke-width:2.0;" width="846.5" x="46" y="798"/><rect fill="#FFFFFF" height="93.2" style="stroke:none;stroke-width:1.0;" width="846.5" x="46" y="894.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="76.3998" y2="230.7998"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="230.7998" y2="258.7998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="258.7998" y2="317.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="317.9999" y2="345.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="345.9999" y2="415.1999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="415.1999" y2="443.1999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="443.1999" y2="535.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="535.9999" y2="563.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="563.9999" y2="609.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="609.2" y2="637.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="637.2" y2="668.8"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="668.8" y2="696.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="696.8" y2="766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="766" y2="794"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="794" y2="886.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="886.8001" y2="914.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="914.8001" y2="942.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="942.8001" y2="1138.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="76.3998" y2="230.7998"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="230.7998" y2="258.7998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="258.7998" y2="317.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="317.9999" y2="345.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="345.9999" y2="415.1999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="415.1999" y2="443.1999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="443.1999" y2="535.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="535.9999" y2="563.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="563.9999" y2="609.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="609.2" y2="637.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="637.2" y2="668.8"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="668.8" y2="696.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="696.8" y2="766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="766" y2="794"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="794" y2="886.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="886.8001" y2="914.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="146.5" x2="146.5" y1="914.8001" y2="942.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="146.5" y1="942.8001" y2="1138.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="76.3998" y2="230.7998"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="230.7998" y2="258.7998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="258.7998" y2="317.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="317.9999" y2="345.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="345.9999" y2="415.1999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="415.1999" y2="443.1999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="443.1999" y2="535.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="535.9999" y2="563.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="563.9999" y2="609.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="609.2" y2="637.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="637.2" y2="668.8"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="668.8" y2="696.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="696.8" y2="766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="766" y2="794"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="794" y2="886.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="886.8001" y2="914.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="532.5" x2="532.5" y1="914.8001" y2="942.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="532.5" y1="942.8001" y2="1138.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="76.3998" y2="230.7998"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="230.7998" y2="258.7998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="258.7998" y2="317.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="317.9999" y2="345.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="345.9999" y2="415.1999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="415.1999" y2="443.1999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="443.1999" y2="535.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="535.9999" y2="563.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="563.9999" y2="609.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="609.2" y2="637.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="637.2" y2="668.8"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="668.8" y2="696.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="696.8" y2="766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="766" y2="794"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="794" y2="886.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="886.8001" y2="914.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="876.5" x2="876.5" y1="914.8001" y2="942.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="876.5" x2="876.5" y1="942.8001" y2="1138.8001"/><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="65" x="27.5" y="40.5999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="34.5" y="60.6058">Listener</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="76" x="106.5" y="40.5999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="113.5" y="60.6058">Controller</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="119" x="471" y="40.5999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="478" y="60.6058">ZigPC Discovery</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="113" x="818" y="40.5999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="825" y="60.6058">ZigPC Gateway</text><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="946.5" x="5" y="105.1998"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="951.5" y1="105.1998" y2="105.1998"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="951.5" y1="108.1998" y2="108.1998"/><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="279" x="338.75" y="94.3998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="261" x="344.75" y="110.4768">Register p_listener (for all device updates)</text><polygon fill="#A80036" points="520.5,145.5998,530.5,149.5998,520.5,153.5998,524.5,149.5998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="526.5" y1="149.5998" y2="149.5998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="69" y="144.0768">add_listener(listener_callback)</text><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="946.5" x="5" y="178.3998"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="951.5" y1="178.3998" y2="178.3998"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="951.5" y1="181.3998" y2="181.3998"/><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="360" x="298.25" y="167.5998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="342" x="304.25" y="183.6768">Start Interview with callback (for single device updates)</text><polygon fill="#A80036" points="520.5,218.7998,530.5,222.7998,520.5,226.7998,524.5,222.7998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="526.5" y1="222.7998" y2="222.7998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="153.5" y="217.2768">interview_device(EUI64_X,controller_callback)</text><polygon fill="#A80036" points="157.5,276.3999,147.5,280.3999,157.5,284.3999,153.5,280.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="531.5" y1="280.3999" y2="280.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303" x="163.5" y="274.8769">controller_callback(EUI64_X, DISCOVERY_START)</text><polygon fill="#A80036" points="73,305.9999,63,309.9999,73,313.9999,69,309.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="531.5" y1="309.9999" y2="309.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="79" y="304.4769">listener_callback(EUI64_X, DISCOVERY_START)</text><path d="M425.5,350.9999 L425.5,375.9999 L635.5,375.9999 L635.5,360.9999 L625.5,350.9999 L425.5,350.9999 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M625.5,350.9999 L625.5,360.9999 L635.5,360.9999 L625.5,350.9999 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="431.5" y="368.0769">Discover endpoints under device</text><polygon fill="#A80036" points="864.5,403.1999,874.5,407.1999,864.5,411.1999,868.5,407.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="870.5" y1="407.1999" y2="407.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="539.5" y="401.6769">Send DiscoverDevice Request for EUI64_X</text><path d="M8,447.1999 L68,447.1999 L68,454.1999 L58,464.1999 L8,464.1999 L8,447.1999 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="667.6002" style="stroke:#000000;stroke-width:2.0;" width="934.5" x="8" y="447.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="23" y="460.2769">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142" x="83" y="459.4188">[DeviceDiscovery Timeout]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="8" x2="942.5" y1="544.9999" y2="544.9999"/><polygon fill="#A80036" points="157.5,492.3999,147.5,496.3999,157.5,500.3999,153.5,496.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="531.5" y1="496.3999" y2="496.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="163.5" y="490.8769">controller_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="73,521.9999,63,525.9999,73,529.9999,69,525.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="531.5" y1="525.9999" y2="525.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="79" y="520.4769">listener_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="543.5,597.2,533.5,601.2,543.5,605.2,539.5,601.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537.5" x2="875.5" y1="601.2" y2="601.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="549.5" y="580.077">Receive DiscoverDevice Response for EUI64_X</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="553.5" y="595.677">ActiveEndpointList: [1,2,3]</text><path d="M27,641.2 L100,641.2 L100,648.2 L90,658.2 L27,658.2 L27,641.2 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="360.8001" style="stroke:#000000;stroke-width:2.0;" width="890.5" x="27" y="641.2"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="42" y="654.277">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="158" x="115" y="653.4189">[for EP in ActiveEndpointList]</text><path d="M404,701.8 L404,726.8 L657,726.8 L657,711.8 L647,701.8 L404,701.8 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M647,701.8 L647,711.8 L657,711.8 L647,701.8 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="410" y="718.877">Discover clusters under EP sequentially</text><polygon fill="#A80036" points="864.5,754,874.5,758,864.5,762,868.5,758" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532.5" x2="870.5" y1="758" y2="758"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="539.5" y="752.477">Send DiscoverEndpoint Request for EUI64_X::EP</text><path d="M46,798 L106,798 L106,805 L96,815 L46,815 L46,798 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="190.0001" style="stroke:#000000;stroke-width:2.0;" width="846.5" x="46" y="798"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="61" y="811.077">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="156" x="121" y="810.2189">[EndpointDiscovery Timeout]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46" x2="892.5" y1="895.8001" y2="895.8001"/><polygon fill="#A80036" points="157.5,843.2,147.5,847.2,157.5,851.2,153.5,847.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="531.5" y1="847.2" y2="847.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362" x="163.5" y="841.677">controller_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="73,872.8001,63,876.8001,73,880.8001,69,876.8001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="531.5" y1="876.8001" y2="876.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="79" y="871.277">listener_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="543.5,976.0001,533.5,980.0001,543.5,984.0001,539.5,980.0001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537.5" x2="875.5" y1="980.0001" y2="980.0001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="549.5" y="958.8771">Receive EndpointDiscover Response for EUI64_X::EP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="553.5" y="974.4771">{serverClusters: [1,4,6], clientClusters: [4]}</text><path d="M384.5,1021.0001 L384.5,1046.0001 L676.5,1046.0001 L676.5,1031.0001 L666.5,1021.0001 L384.5,1021.0001 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M666.5,1021.0001 L666.5,1031.0001 L676.5,1031.0001 L666.5,1021.0001 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="390.5" y="1038.0771">All Endpoints Discovered, Discovery Complete</text><polygon fill="#A80036" points="157.5,1073.2001,147.5,1077.2001,157.5,1081.2001,153.5,1077.2001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="531.5" y1="1077.2001" y2="1077.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323" x="163.5" y="1071.6771">controller_callback(EUI64_X, DISCOVERY_SUCCESS)</text><polygon fill="#A80036" points="73,1102.8001,63,1106.8001,73,1110.8001,69,1106.8001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="531.5" y1="1106.8001" y2="1106.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="79" y="1101.2771">listener_callback(EUI64_X, DISCOVERY_SUCCESS)</text><!--MD5=[699b30db6bdbcf90516ef5ddbfb6ff7a]
@startuml inline_umlgraph_3.svg
!pragma teoz true
participant "Listener" as p_listener
participant "Controller" as p_controller
participant "ZigPC Discovery" as p_discovery
participant "ZigPC Gateway" as p_gateway
hide footbox
title "ZigPC Discovery Behaviour"
== Register p_listener (for all device updates) ==
p_listener -> p_discovery: add_listener(listener_callback)
== Start Interview with callback (for single device updates) ==
p_controller -> p_discovery: interview_device(EUI64_X,controller_callback)
...
p_controller <- p_discovery: controller_callback(EUI64_X, DISCOVERY_START)
p_listener <- p_discovery: listener_callback(EUI64_X, DISCOVERY_START)
...
note over p_discovery
Discover endpoints under device
end note
p_discovery -> p_gateway: Send DiscoverDevice Request for EUI64_X
...
alt #pink DeviceDiscovery Timeout
  p_controller <- p_discovery: controller_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)
  p_listener <- p_discovery: listener_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)
else #white
  ...
  p_discovery <- p_gateway: Receive DiscoverDevice Response for EUI64_X \n ActiveEndpointList: [1,2,3]
  ...
  loop for EP in ActiveEndpointList
    ...
    note over p_discovery
    Discover clusters under EP sequentially
    end note
    p_discovery -> p_gateway: Send DiscoverEndpoint Request for EUI64_X::EP
    ...
    alt #pink EndpointDiscovery Timeout
      p_controller <- p_discovery: controller_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)
      p_listener <- p_discovery: listener_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)
    else #white
      ...
      ...
      p_discovery <- p_gateway: Receive EndpointDiscover Response for EUI64_X::EP \n {serverClusters: [1,4,6], clientClusters: [4]}
    end alt
  end loop

  note over p_discovery
  All Endpoints Discovered, Discovery Complete
  end note
  p_controller <- p_discovery: controller_callback(EUI64_X, DISCOVERY_SUCCESS)
  p_listener <- p_discovery: listener_callback(EUI64_X, DISCOVERY_SUCCESS)
end alt
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>