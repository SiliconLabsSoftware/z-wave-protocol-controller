<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="933px" preserveAspectRatio="none" style="width:747px;height:933px;background:#FFFFFF;" version="1.1" viewBox="0 0 747 933" width="747px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jrwifkwqcah9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFE0" height="921.1404" style="stroke:#A80036;stroke-width:1.0;" width="92" x="57" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="86" x="60" y="19.897">MQTT Broker</text><rect fill="#ADD8E6" height="921.1404" style="stroke:#A80036;stroke-width:1.0;" width="468.5" x="272.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="494.75" y="19.897">ZPC</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="103" x2="103" y1="65.7739" y2="886.0725"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="368.5" x2="368.5" y1="65.7739" y2="886.0725"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="655" x2="655" y1="65.7739" y2="886.0725"/><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="54" x="74" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="81" y="49.672">MQTT</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="54" x="74" y="885.0725"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="81" y="907.0384">MQTT</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="181" x="276.5" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="283.5" y="49.672">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="181" x="276.5" y="885.0725"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="283.5" y="907.0384">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="160" x="573" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="580" y="49.672">NetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="160" x="573" y="885.0725"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="580" y="907.0384">NetworkManagement</text><path d="M23,80.7739 L23,107.7739 L179,107.7739 L179,90.7739 L169,80.7739 L23,80.7739 " fill="#FBFB77" filter="url(#f1jrwifkwqcah9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M169,80.7739 L169,90.7739 L179,90.7739 L169,80.7739 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="29" y="99.6709">User trigger Add Node</text><polygon fill="#A80036" points="357,190.304,367,194.304,357,198.304,361,194.304" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="103" x2="363" y1="194.304" y2="194.304"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="110" y="135.377">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="110" y="153.083">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="156" x="110" y="170.789">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="110" y="188.495">{"State": "add node", ...}</text><polygon fill="#A80036" points="643,222.01,653,226.01,643,230.01,647,226.01" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369" x2="649" y1="226.01" y2="226.01"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="376" y="220.201">zwave_network_management_add_node()</text><polygon fill="#A80036" points="380,253.716,370,257.716,380,261.716,376,257.716" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374" x2="654" y1="257.716" y2="257.716"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="386" y="251.907">on_state_updated(NM_WAITING_FOR_ADD)</text><polygon fill="#A80036" points="114,338.5401,104,342.5401,114,346.5401,110,342.5401" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="108" x2="368" y1="342.5401" y2="342.5401"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="120" y="283.6131">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="120" y="301.3191">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="122" x="120" y="319.0251">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="120" y="336.7311">{"State": "add node", ...}</text><polygon fill="#A80036" points="380,370.2461,370,374.2461,380,378.2461,376,374.2461" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374" x2="654" y1="374.2461" y2="374.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="386" y="368.4371">on_keys_reported()</text><polygon fill="#A80036" points="643,401.9521,653,405.9521,643,409.9521,647,405.9521" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369" x2="649" y1="405.9521" y2="405.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="376" y="400.1431">zwave_network_management_keys_set()</text><polygon fill="#A80036" points="380,433.6582,370,437.6582,380,441.6582,376,437.6582" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374" x2="654" y1="437.6582" y2="437.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="386" y="431.8492">on_dsk_report()</text><polygon fill="#A80036" points="114,536.1882,104,540.1882,114,544.1882,110,540.1882" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="108" x2="368" y1="540.1882" y2="540.1882"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="120" y="463.5552">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="120" y="481.2612">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="122" x="120" y="498.9672">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="120" y="516.6732">{"State": "add node",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="120" y="534.3792">&lt;Request DSK&gt;}</text><path d="M5,553.1882 L5,633.1882 L198,633.1882 L198,563.1882 L188,553.1882 L5,553.1882 " fill="#FBFB77" filter="url(#f1jrwifkwqcah9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M188,553.1882 L188,563.1882 L198,563.1882 L188,553.1882 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="11" y="572.0853">User decides to supply DSK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="11" y="589.7913">or Reject the DSK, which</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="11" y="607.4973">will end up with a non secure</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="11" y="625.2033">node inclusion</text><polygon fill="#A80036" points="357,733.5424,367,737.5424,357,741.5424,361,737.5424" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="103" x2="363" y1="737.5424" y2="737.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="110" y="660.9093">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="110" y="678.6153">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="156" x="110" y="696.3214">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="110" y="714.0274">{"State":"add node"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="110" y="731.7334">DSK or "UserAccept"=false}</text><polygon fill="#A80036" points="643,765.2484,653,769.2484,643,773.2484,647,769.2484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369" x2="649" y1="769.2484" y2="769.2484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="376" y="763.4394">zwave_network_management_dsk_set()</text><polygon fill="#A80036" points="380,796.9544,370,800.9544,380,804.9544,376,800.9544" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374" x2="654" y1="800.9544" y2="800.9544"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="386" y="795.1454">on_node_added()</text><polygon fill="#A80036" points="114,864.0725,104,868.0725,114,872.0725,110,868.0725" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="108" x2="368" y1="868.0725" y2="868.0725"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="141" x="120" y="826.8514">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="229" x="120" y="844.5575">ProtocolController/NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="120" y="862.2635">NetworkManagement {"State": "Idle"}</text><!--MD5=[a4587a92386ffbcf2aeae8ad806e97ac]
@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  '<i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\n{"State": "Idle"}
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

PlantUML version 1.2022.0(Tue Jan 11 17:16:42 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>