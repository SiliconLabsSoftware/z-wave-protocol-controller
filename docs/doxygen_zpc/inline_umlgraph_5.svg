<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="884px" preserveAspectRatio="none" style="width:737px;height:884px;background:#FFFFFF;" version="1.1" viewBox="0 0 737 884" width="737px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jrwifkwqcah9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFE0" height="872.3003" style="stroke:#A80036;stroke-width:1.0;" width="88" x="57" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="60" y="18.077">MQTT Broker</text><rect fill="#ADD8E6" height="872.3003" style="stroke:#A80036;stroke-width:1.0;" width="458" x="273.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="489.5" y="18.077">ZPC</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="100.5" x2="100.5" y1="61.3999" y2="839.5004"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="364.5" x2="364.5" y1="61.3999" y2="839.5004"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="650.5" x2="650.5" y1="61.3999" y2="839.5004"/><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="55" x="71.5" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="78.5" y="45.606">MQTT</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="55" x="71.5" y="838.5004"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="78.5" y="858.5063">MQTT</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="170" x="277.5" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="284.5" y="45.606">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="170" x="277.5" y="838.5004"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="284.5" y="858.5063">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="150" x="573.5" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="580.5" y="45.606">NetworkManagement</text><rect fill="#FEFECE" filter="url(#f1jrwifkwqcah9)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="150" x="573.5" y="838.5004"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="580.5" y="858.5063">NetworkManagement</text><path d="M24,76.3999 L24,101.3999 L173,101.3999 L173,86.3999 L163,76.3999 L24,76.3999 " fill="#FBFB77" filter="url(#f1jrwifkwqcah9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M163,76.3999 L163,86.3999 L173,86.3999 L163,76.3999 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="30" y="93.477">User trigger Add Node</text><polygon fill="#A80036" points="352.5,181.25,362.5,185.25,352.5,189.25,356.5,185.25" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="101" x2="358.5" y1="185.25" y2="185.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="135" x="108" y="129.3">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="108" y="146.85">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="156" x="108" y="164.4">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="108" y="179.727">{"State": "add node", ...}</text><polygon fill="#A80036" points="638.5,210.85,648.5,214.85,638.5,218.85,642.5,214.85" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="364.5" x2="644.5" y1="214.85" y2="214.85"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="371.5" y="209.327">zwave_network_management_add_node()</text><polygon fill="#A80036" points="375.5,240.45,365.5,244.45,375.5,248.45,371.5,244.45" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369.5" x2="649.5" y1="244.45" y2="244.45"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="381.5" y="238.927">on_state_updated(NM_WAITING_FOR_ADD)</text><polygon fill="#A80036" points="112,322.7001,102,326.7001,112,330.7001,108,326.7001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="106" x2="363.5" y1="326.7001" y2="326.7001"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="135" x="118" y="270.7501">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="118" y="288.3001">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="122" x="118" y="305.8501">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="118" y="321.1771">{"State": "add node", ...}</text><polygon fill="#A80036" points="375.5,352.3001,365.5,356.3001,375.5,360.3001,371.5,356.3001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369.5" x2="649.5" y1="356.3001" y2="356.3001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="381.5" y="350.7771">on_keys_reported()</text><polygon fill="#A80036" points="638.5,381.9001,648.5,385.9001,638.5,389.9001,642.5,385.9001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="364.5" x2="644.5" y1="385.9001" y2="385.9001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="371.5" y="380.3771">zwave_network_management_keys_set()</text><polygon fill="#A80036" points="375.5,411.5001,365.5,415.5001,375.5,419.5001,371.5,415.5001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369.5" x2="649.5" y1="415.5001" y2="415.5001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="381.5" y="409.9771">on_dsk_report()</text><polygon fill="#A80036" points="112,509.3502,102,513.3502,112,517.3502,108,513.3502" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="106" x2="363.5" y1="513.3502" y2="513.3502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="135" x="118" y="441.8001">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="118" y="459.3502">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="122" x="118" y="476.9002">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="118" y="492.2272">{"State": "add node",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="118" y="507.8272">&lt;Request DSK&gt;}</text><path d="M5,526.3502 L5,598.3502 L193,598.3502 L193,536.3502 L183,526.3502 L5,526.3502 " fill="#FBFB77" filter="url(#f1jrwifkwqcah9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M183,526.3502 L183,536.3502 L193,536.3502 L183,526.3502 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="11" y="543.4272">User decides to supply DSK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="11" y="559.0272">or Reject the DSK, which</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="11" y="574.6272">will end up with a non secure</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="11" y="590.2273">node inclusion</text><polygon fill="#A80036" points="352.5,693.6003,362.5,697.6003,352.5,701.6003,356.5,697.6003" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="101" x2="358.5" y1="697.6003" y2="697.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="135" x="108" y="626.0503">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107" x="108" y="643.6003">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="156" x="108" y="661.1503">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="108" y="676.4773">{"State":"add node"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="108" y="692.0773">DSK or "UserAccept"=false}</text><polygon fill="#A80036" points="638.5,723.2003,648.5,727.2003,638.5,731.2003,642.5,727.2003" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="364.5" x2="644.5" y1="727.2003" y2="727.2003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="371.5" y="721.6773">zwave_network_management_dsk_set()</text><polygon fill="#A80036" points="375.5,752.8004,365.5,756.8004,375.5,760.8004,371.5,756.8004" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="369.5" x2="649.5" y1="756.8004" y2="756.8004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="381.5" y="751.2774">on_node_added()</text><polygon fill="#A80036" points="112,817.5004,102,821.5004,112,825.5004,108,821.5004" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="106" x2="363.5" y1="821.5004" y2="821.5004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="135" x="118" y="783.1004">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="229" x="118" y="800.6504">ProtocolController/NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="118" y="815.9774">NetworkManagement {"State": "Idle"}</text><!--MD5=[8f2784b2a49f20297e06e51a1e51a5c1]
@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  '<i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\n{"State": "Idle"}
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>